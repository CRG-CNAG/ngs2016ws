= CRG RNAseq course cheatsheet image:assets/crg_blue_logo.jpg[CRG Barcelona, 175, 80, role="right"]
:sectnums:
:hide-uri-scheme:
:nofooter:
:icons: font
:experimental:
// links
:awk: http://www.grymoire.com/Unix/Awk.html
:awk-examples: http://www.tutorialspoint.com/awk/awk_basic_examples.htm
:vim-beginners-guide: http://www.howtogeek.com/102468/a-beginners-guide-to-editing-text-files-with-vi
:linux-crg-es: http://www.linux.crg.es

== Basic Linux Commands

=== Browse the directory structure

[cols="^,1*"]
|===
| `pwd`                    | tells you where you are
| `ls`                     | list the content of the current directory
| `ls <directory name>`    | list the content of a directory
| `cd <directory name>`    | go to the specified directory
| `cd  ~` (or `cd`)        | go to your home directory
| `cd  ..`                 | go to the parent directory
| `tree <directory name>`  | list the content of a directory in a tree-like format
| `mkdir <directory name>` | creates specified directory
|===

=== View the content of a file

[cols="^,1*"]
|===
| `less`, `more` | view text with paging
| `head`         | prints first lines of a file
| `tail`         | prints last lines of a file
| `cat`          | print content of a file into the screen
| `zcat`         | print content of a `gzip` compressed file
|===

=== File manipulations

[cols="^,1*"]
|===
| `rm <file name>`     | remove file
| `cp <file1> <file2>` | copy file1 into file2
| `mv <file1> <file2>` | rename file1 to file2
|===

=== Some other useful commands

[cols="^,1*"]
|===
| `grep <pattern>`         | show lines of text containing a given pattern
| `grep -v <pattern>`       | show lines of text not containing a given pattern
| `sort`                   | sort linesof text files
| `wc`                     | counting words, lines and characters
| `>` (output redirection)  | allows to redirect the output to a file
| `\|` (pipe)               | allows to send output from one program to another
| `cut`                    | to extract portion of a file by selecting columns
| `echo`                    | input a line of text and display it on standard output
|===

=== AWK programming

**AWK** - UNIX shell programming language. A fast and stable tool for processing
text files.

[cols="^,1*"]
|===
| `awk '/www/ { print $0 }' <file>` | search for the pattern 'www' in the each line of the file
| `awk '$3=="www"' <file>`          | search for pattern 'www' in the third column of the file
| `awk 'length($0) > 80' <file>`    | print every line in the file that is longer than 80 characters
| `awk 'NR % 2 == 0' <file>`        | print even-numbered lines in the file
|===

==== Some built-in variables

[cols="^,1*"]
|===
| `NR`  | Number of records
| `NF`  | Number of fields
| `FS`  | Field separator character
| `OFS` | Output field separator character
|===

NOTE: See {awk}[^] and {awk-examples}[^] for more information

== Writing and editing files

There are several ways to write and edit files.
The most commonly used text editors are `vi`, `emacs` and `gedit`.

=== Gedit

Gedit is a text editor with graphical user interface. To create a new file in the current folder just call `gedit` with the name of the file:

[source,bash]
----
gedit file.txt
----

When you are done, save the file (by pressing kbd:[Ctrl+S] or by selecting menu:File[Save]) and close Gedit.

=== Vi

Vi is a text editor with a command mode interface. See {vim-beginners-guide}[this article^] for a beginner's guide.

To create a new file in the current folder just call `vi` with the name of the file:

[source,bash]
----
vi file.txt
----

Vi has several modes which are specified in the bottom part of screen.
When you just open the editor you cannot write on the file, because it is the command mode.
To start writing, press kbd:[i], and you will notice that the status in the bottom of the screen changed to `INSERT`.
Now you can paste the text by right-click with the mouse and paste, or by pressing kbd:[SHIFT+Insert].
To go back to command mode press kbd:[ESC].
To save, make sure you are in command mode and type:

[source,vim]
----
:wq
----

To undo, press kbd:[u] when you are in command mode.

== Basic Cluster Commands

[cols="^,1*"]
|===
| `ssh -Y username@ant-login.linux.crg.es` | access to the cluster - the `-Y` option
                                             allows graphical output (**X11** forwarding)
| `qsub -q <queue> <script>`               | submit a batch job to a specific queue
| `qstat`                                  | monitor the status of submitted jobs
| `qstat -j <job_id>`                      | display detailed information of a specific
                                            job
| `qdel <job_id>`                          | delete a submitted job
|===

The `job_id` is an important number that identifies your job in the cluster. It's
necessary for managing the job and control it.

A simple example of job submission and deletion:

[source,bash]
----
$ qsub -q course sleeper.sh
Your job 393672 ("sleeper.sh") has been submitted

$ qstat
job-ID     prior   name       user      state submit/start at   queue         jclass      slots ja-task-ID
----------------------------------------------------------------------------------------------------------
  393672   0.00000 sleeper.sh epalumbo  qw    11/09/2015 11:18:01                               1

$ qdel 393672
epalumbo has deleted job 393672
----

NOTE: See {linux-crg-es}[^] for the complete **CRG** cluster documentation
